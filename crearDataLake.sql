CREATE TABLE public.data_lake_vacunacion (
    IdPaciente VARCHAR(200),
    TipoIdentificacion VARCHAR(200),
    Documento VARCHAR(200),
    PrimerNombre VARCHAR(200),
    PrimerApellido VARCHAR(200),
    direccionResidencia VARCHAR(200),
    Sexo VARCHAR(200),
    FechaNacimiento DATE,
    CodMunicipioNacimiento VARCHAR(200),
    NombreMunicipioNacimiento VARCHAR(200),
    CodDptoNacimiento VARCHAR(200),
    NombreDptoNacimiento VARCHAR(200),
    CodMunicipioResidencia VARCHAR(200),
    NombreMunicipioResidencia VARCHAR(200),
    CodDptoResidencia VARCHAR(200),
    NombreDptoResidencia VARCHAR(200),
    GrupoEtnico VARCHAR(200),
    Desplazado VARCHAR(200),
    Discapacitado VARCHAR(200),
    RegimenAfiliacion VARCHAR(200),
    CodigoAseguradora VARCHAR(200),
    NombreAseguradora VARCHAR(200),
    BCG_UNICA VARCHAR(200),
    HB_PEDIATRICA_PRIMERA VARCHAR(200),
    HB_PEDIATRICA_SEGUNDA VARCHAR(200),
    HB_PEDIATRICA_TERCERA VARCHAR(200),
    HB_PEDIATRICA_REFUERZO VARCHAR(200),
    HB_ADULTOS_PRIMERA VARCHAR(200),
    HB_ADULTOS_SEGUNDA VARCHAR(200),
    HB_ADULTOS_TERCERA VARCHAR(200),
    HB_ADULTOS_REFUERZO VARCHAR(200),
    HB_HA_PRIMERA VARCHAR(200),
    HB_HA_SEGUNDA VARCHAR(200),
    HB_HA_TERCERA VARCHAR(200),
    POLIO_INACTIVADO_VIP_PRIMERA VARCHAR(200),
    POLIO_INACTIVADO_VIP_SEGUNDA VARCHAR(200),
    POLIO_INACTIVADO_VIP_TERCERA VARCHAR(200),
    POLIO_INACTIVADO_VIP_PRIMER_REFUERZO VARCHAR(200),
    POLIO_INACTIVADO_VIP_SEGUNDO_REFUERZO VARCHAR(200),
    POLIO_ORAL_VOP_PRIMERA VARCHAR(200),
    POLIO_ORAL_VOP_SEGUNDA VARCHAR(200),
    POLIO_ORAL_VOP_TERCERA VARCHAR(200),
    POLIO_ORAL_VOP_PRIMER_REFUERZO VARCHAR(200),
    POLIO_ORAL_VOP_SEGUNDO_REFUERZO VARCHAR(200),
    POLIO_ORAL_VOP_ADICIONAL VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_PRIMERA VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_SEGUNDA VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_TERCERA VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_PRIMER_REFUERZO VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_SEGUNDO_REFUERZO VARCHAR(200),
    PENTAVALENTE_DPTa_Hib_HB_UNICA VARCHAR(200),
    PENTAVALENTE_DPTa_VIP_Hib_PRIMERA VARCHAR(200),
    PENTAVALENTE_DPTa_VIP_Hib_SEGUNDA VARCHAR(200),
    PENTAVALENTE_DPTa_VIP_Hib_TERCERA VARCHAR(200),
    PENTAVALENTE_DPTa_VIP_Hib_PRIMER_REFUERZO VARCHAR(200),
    HEXAVALENTE_PRIMERA VARCHAR(200),
    HEXAVALENTE_SEGUNDA VARCHAR(200),
    HEXAVALENTE_TERCERA VARCHAR(200),
    HEXAVALENTE_REFUERZO VARCHAR(200),
    TETRAVALENTE_DPT_Y_VIP_PRIMERA VARCHAR(200),
    TETRAVALENTE_DPT_Y_VIP_SEGUNDA VARCHAR(200),
    TETRAVALENTE_DPT_Y_VIP_TERCERA VARCHAR(200),
    TETRAVALENTE_DPT_Y_VIP_PRIMER_REFUERZO VARCHAR(200),
    TETRAVALENTE_DPT_Y_VIP_SEGUNDO_REFUERZO VARCHAR(200),
    ROTAVIRUS_PRIMERA VARCHAR(200),
    ROTAVIRUS_SEGUNDA VARCHAR(200),
    ROTAVIRUS_TERCERA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_10_VALENTE_PRIMERA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_10_VALENTE_SEGUNDA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_10_VALENTE_REFUERZO VARCHAR(200),
    NEUMOCOCO_CONJUGADO_13_VALENTE_PRIMERA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_13_VALENTE_SEGUNDA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_13_VALENTE_TERCERA VARCHAR(200),
    NEUMOCOCO_CONJUGADO_13_VALENTE_REFUERZO VARCHAR(200),
    INFLUENZA_PEDIATRICA_PRIMERA VARCHAR(200),
    INFLUENZA_PEDIATRICA_SEGUNDA VARCHAR(200),
    INFLUENZA_PEDIATRICA_TERCERA VARCHAR(200),
    INFLUENZA_PEDIATRICA_REFUERZO VARCHAR(200),
    INFLUENZA_ADULTOS_ANUAL VARCHAR(200),
    TRIPLE_VIRAL_PRIMERA VARCHAR(200),
    TRIPLE_VIRAL_REFUERZO VARCHAR(200),
    SARAMPION_RUBEOLA_ADICIONAL VARCHAR(200),
    TRIPLE_VIRAL_Y_VARICELA_PRIMERA VARCHAR(200),
    TRIPLE_VIRAL_Y_VARICELA_SEGUNDA VARCHAR(200),
    HA_PEDIATRICA_PRIMERA VARCHAR(200),
    HA_PEDIATRICA_SEGUNDA VARCHAR(200),
    HA_PEDIATRICA_UNICA VARCHAR(200),
    HA_ADULTOS_PRIMERA VARCHAR(200),
    HA_ADULTOS_SEGUNDA VARCHAR(200),
    TD_PEDIATRICO_PRIMERA VARCHAR(200),
    TD_PEDIATRICO_SEGUNDA VARCHAR(200),
    TD_PEDIATRICO_TERCERA VARCHAR(200),
    TD_PEDIATRICO_PRIMER_REFUERZO VARCHAR(200),
    TD_PEDIATRICO_SEGUNDO_REFUERZO VARCHAR(200),
    TD_ADULTOS_PRIMERA VARCHAR(200),
    TD_ADULTOS_SEGUNDA VARCHAR(200),
    TD_ADULTOS_TERCERA VARCHAR(200),
    TD_ADULTOS_PRIMER_REFUERZO VARCHAR(200),
    TD_ADULTOS_SEGUNDO_REFUERZO VARCHAR(200),
    TD_ADULTOS_CUARTA VARCHAR(200),
    TD_ADULTOS_QUINTA VARCHAR(200),
    DPT_PRIMERA VARCHAR(200),
    DPT_SEGUNDA VARCHAR(200),
    DPT_TERCERA VARCHAR(200),
    DPT_PRIMER_REFUERZO VARCHAR(200),
    DPT_SEGUNDO_REFUERZO VARCHAR(200),
    TdaP_PEDIATRICO_PRIMERA VARCHAR(200),
    TdaP_PEDIATRICO_SEGUNDA VARCHAR(200),
    TdaP_PEDIATRICO_TERCERA VARCHAR(200),
    TdaP_PEDIATRICO_PRIMER_REFUERZO VARCHAR(200),
    TdaP_PEDIATRICO_SEGUNDO_REFUERZO VARCHAR(200),
    TdaP_ADULTO_REFUERZO VARCHAR(200),
    TdaP_ADULTO_UNICA VARCHAR(200),
    TdaP_GESTANTE_ANUAL VARCHAR(200),
    FA_UNICA VARCHAR(200),
    VARICELA_PRIMERA VARCHAR(200),
    VARICELA_REFUERZO VARCHAR(200),
    VPH_PRIMERA VARCHAR(200),
    VPH_SEGUNDA VARCHAR(200),
    VPH_TERCERA VARCHAR(200),
    COVID_SINOVAC_PRIMERA VARCHAR(200),
    COVID_SINOVAC_SEGUNDA VARCHAR(200),
    COVID_SINOVAC_REFUERZO VARCHAR(200),
    COVID_SINOVAC_PRIMER_REFUERZO VARCHAR(200),
    COVID_SINOVAC_SEGUNDO_REFUERZO VARCHAR(200),
    COVID_PFIZER_PRIMERA VARCHAR(200),
    COVID_PFIZER_SEGUNDA VARCHAR(200),
    COVID_PFIZER_REFUERZO VARCHAR(200),
    COVID_PFIZER_PRIMER_REFUERZO VARCHAR(200),
    COVID_PFIZER_SEGUNDO_REFUERZO VARCHAR(200),
    COVID_MODERNA_PRIMERA VARCHAR(200),
    COVID_MODERNA_SEGUNDA VARCHAR(200),
    COVID_MODERNA_REFUERZO VARCHAR(200),
    COVID_MODERNA_PRIMER_REFUERZO VARCHAR(200),
    COVID_MODERNA_SEGUNDO_REFUERZO VARCHAR(200),
    COVID_JANSSEN_UNICA VARCHAR(200),
    COVID_JANSSEN_SEGUNDA VARCHAR(200),
    COVID_JANSSEN_REFUERZO VARCHAR(200),
    COVID_JANSSEN_PRIMER_REFUERZO VARCHAR(200),
    COVID_JANSSEN_SEGUNDO_REFUERZO VARCHAR(200),
    COVID_ASTRAZENECA_PRIMERA VARCHAR(200),
    COVID_ASTRAZENECA_SEGUNDA VARCHAR(200),
    COVID_ASTRAZENECA_REFUERZO VARCHAR(200),
    COVID_ASTRAZENECA_PRIMER_REFUERZO VARCHAR(200),
    COVID_ASTRAZENECA_SEGUNDO_REFUERZO VARCHAR(200),
    INMONOGLOBULINA_ANTITETANICA_UNICA VARCHAR(200),
    INMONOGLOBULINA_ANTIHEPATITIS_B_UNICA VARCHAR(200),
    INMONOGLOBULINA_ANTIDIFTERICA_UNICA VARCHAR(200),
    INMONOGLOBULINA_ANTIRRABICA_HUMANA_UNICA VARCHAR(200),
    VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_PRIMERA VARCHAR(200),
    VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_SEGUNDA VARCHAR(200),
    VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_TERCERA VARCHAR(200),
    VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_CUARTA VARCHAR(200),
    VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_QUINTA VARCHAR(200),
    ANTITOXINA_TETANICA_UNICA VARCHAR(200),
    ANTITOXINA_DIFTERICA_UNICA VARCHAR(200),
    MENINGOCOCO_TETRAVALENTE_ACY_PRIMERA VARCHAR(200),
    MENINGOCOCO_TETRAVALENTE_ACY_SEGUNDA VARCHAR(200),
    MENINGOCOCO_TETRAVALENTE_ACY_REFUERZO VARCHAR(200),
    COVID_MODERNA_PEDIATRICA_PRIMERA VARCHAR(200),
    COVID_MODERNA_PEDIATRICA_SEGUNDA VARCHAR(200),
    COVID_PFIZER_ADICIONAL VARCHAR(200),
    VPH_UNICA VARCHAR(200),
    ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_PRIMERA VARCHAR(200),
    ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_SEGUNDA VARCHAR(200),
    ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_TERCERA VARCHAR(200),
    ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_REFUERZO VARCHAR(200),
    COVID_MODERNA_BIVALENTE_ADICIONAL VARCHAR(200),
    Codigo_Entidad VARCHAR(200),
    estado VARCHAR(200)
);

select * from public.data_lake_vacunacion;

-- En caso de que la data cargue mal, borrala
delete from public.data_lake_vacunacion;

COPY public.data_lake_vacunacion (IdPaciente, TipoIdentificacion, Documento, PrimerNombre, PrimerApellido, direccionResidencia, Sexo, FechaNacimiento, CodMunicipioNacimiento, NombreMunicipioNacimiento, CodDptoNacimiento, NombreDptoNacimiento, CodMunicipioResidencia, NombreMunicipioResidencia, CodDptoResidencia, NombreDptoResidencia, GrupoEtnico, Desplazado, Discapacitado, RegimenAfiliacion, CodigoAseguradora, NombreAseguradora, BCG_UNICA, HB_PEDIATRICA_PRIMERA, HB_PEDIATRICA_SEGUNDA, HB_PEDIATRICA_TERCERA, HB_PEDIATRICA_REFUERZO, HB_ADULTOS_PRIMERA, HB_ADULTOS_SEGUNDA, HB_ADULTOS_TERCERA, HB_ADULTOS_REFUERZO, HB_HA_PRIMERA, HB_HA_SEGUNDA, HB_HA_TERCERA, POLIO_INACTIVADO_VIP_PRIMERA, POLIO_INACTIVADO_VIP_SEGUNDA, POLIO_INACTIVADO_VIP_TERCERA, POLIO_INACTIVADO_VIP_PRIMER_REFUERZO, POLIO_INACTIVADO_VIP_SEGUNDO_REFUERZO, POLIO_ORAL_VOP_PRIMERA, POLIO_ORAL_VOP_SEGUNDA, POLIO_ORAL_VOP_TERCERA, POLIO_ORAL_VOP_PRIMER_REFUERZO, POLIO_ORAL_VOP_SEGUNDO_REFUERZO, POLIO_ORAL_VOP_ADICIONAL, PENTAVALENTE_DPTa_Hib_HB_PRIMERA, PENTAVALENTE_DPTa_Hib_HB_SEGUNDA, PENTAVALENTE_DPTa_Hib_HB_TERCERA, PENTAVALENTE_DPTa_Hib_HB_PRIMER_REFUERZO, PENTAVALENTE_DPTa_Hib_HB_SEGUNDO_REFUERZO, PENTAVALENTE_DPTa_Hib_HB_UNICA, PENTAVALENTE_DPTa_VIP_Hib_PRIMERA, PENTAVALENTE_DPTa_VIP_Hib_SEGUNDA, PENTAVALENTE_DPTa_VIP_Hib_TERCERA, PENTAVALENTE_DPTa_VIP_Hib_PRIMER_REFUERZO, HEXAVALENTE_PRIMERA, HEXAVALENTE_SEGUNDA, HEXAVALENTE_TERCERA, HEXAVALENTE_REFUERZO, TETRAVALENTE_DPT_Y_VIP_PRIMERA, TETRAVALENTE_DPT_Y_VIP_SEGUNDA, TETRAVALENTE_DPT_Y_VIP_TERCERA, TETRAVALENTE_DPT_Y_VIP_PRIMER_REFUERZO, TETRAVALENTE_DPT_Y_VIP_SEGUNDO_REFUERZO, ROTAVIRUS_PRIMERA, ROTAVIRUS_SEGUNDA, ROTAVIRUS_TERCERA, NEUMOCOCO_CONJUGADO_10_VALENTE_PRIMERA, NEUMOCOCO_CONJUGADO_10_VALENTE_SEGUNDA, NEUMOCOCO_CONJUGADO_10_VALENTE_REFUERZO, NEUMOCOCO_CONJUGADO_13_VALENTE_PRIMERA, NEUMOCOCO_CONJUGADO_13_VALENTE_SEGUNDA, NEUMOCOCO_CONJUGADO_13_VALENTE_TERCERA, NEUMOCOCO_CONJUGADO_13_VALENTE_REFUERZO, INFLUENZA_PEDIATRICA_PRIMERA, INFLUENZA_PEDIATRICA_SEGUNDA, INFLUENZA_PEDIATRICA_TERCERA, INFLUENZA_PEDIATRICA_REFUERZO, INFLUENZA_ADULTOS_ANUAL, TRIPLE_VIRAL_PRIMERA, TRIPLE_VIRAL_REFUERZO, SARAMPION_RUBEOLA_ADICIONAL, TRIPLE_VIRAL_Y_VARICELA_PRIMERA, TRIPLE_VIRAL_Y_VARICELA_SEGUNDA, HA_PEDIATRICA_PRIMERA, HA_PEDIATRICA_SEGUNDA, HA_PEDIATRICA_UNICA, HA_ADULTOS_PRIMERA, HA_ADULTOS_SEGUNDA, TD_PEDIATRICO_PRIMERA, TD_PEDIATRICO_SEGUNDA, TD_PEDIATRICO_TERCERA, TD_PEDIATRICO_PRIMER_REFUERZO, TD_PEDIATRICO_SEGUNDO_REFUERZO, TD_ADULTOS_PRIMERA, TD_ADULTOS_SEGUNDA, TD_ADULTOS_TERCERA, TD_ADULTOS_PRIMER_REFUERZO, TD_ADULTOS_SEGUNDO_REFUERZO, TD_ADULTOS_CUARTA, TD_ADULTOS_QUINTA, DPT_PRIMERA, DPT_SEGUNDA, DPT_TERCERA, DPT_PRIMER_REFUERZO, DPT_SEGUNDO_REFUERZO, TdaP_PEDIATRICO_PRIMERA, TdaP_PEDIATRICO_SEGUNDA, TdaP_PEDIATRICO_TERCERA, TdaP_PEDIATRICO_PRIMER_REFUERZO, TdaP_PEDIATRICO_SEGUNDO_REFUERZO, TdaP_ADULTO_REFUERZO, TdaP_ADULTO_UNICA, TdaP_GESTANTE_ANUAL, FA_UNICA, VARICELA_PRIMERA, VARICELA_REFUERZO, VPH_PRIMERA, VPH_SEGUNDA, VPH_TERCERA, COVID_SINOVAC_PRIMERA, COVID_SINOVAC_SEGUNDA, COVID_SINOVAC_REFUERZO, COVID_SINOVAC_PRIMER_REFUERZO, COVID_SINOVAC_SEGUNDO_REFUERZO, COVID_PFIZER_PRIMERA, COVID_PFIZER_SEGUNDA, COVID_PFIZER_REFUERZO, COVID_PFIZER_PRIMER_REFUERZO, COVID_PFIZER_SEGUNDO_REFUERZO, COVID_MODERNA_PRIMERA, COVID_MODERNA_SEGUNDA, COVID_MODERNA_REFUERZO, COVID_MODERNA_PRIMER_REFUERZO, COVID_MODERNA_SEGUNDO_REFUERZO, COVID_JANSSEN_UNICA, COVID_JANSSEN_SEGUNDA, COVID_JANSSEN_REFUERZO, COVID_JANSSEN_PRIMER_REFUERZO, COVID_JANSSEN_SEGUNDO_REFUERZO, COVID_ASTRAZENECA_PRIMERA, COVID_ASTRAZENECA_SEGUNDA, COVID_ASTRAZENECA_REFUERZO, COVID_ASTRAZENECA_PRIMER_REFUERZO, COVID_ASTRAZENECA_SEGUNDO_REFUERZO, INMONOGLOBULINA_ANTITETANICA_UNICA, INMONOGLOBULINA_ANTIHEPATITIS_B_UNICA, INMONOGLOBULINA_ANTIDIFTERICA_UNICA, INMONOGLOBULINA_ANTIRRABICA_HUMANA_UNICA, VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_PRIMERA, VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_SEGUNDA, VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_TERCERA, VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_CUARTA, VACUNA_CONTRA_RABIA_HUMANA_INTRAMUSCULAR_QUINTA, ANTITOXINA_TETANICA_UNICA, ANTITOXINA_DIFTERICA_UNICA, MENINGOCOCO_TETRAVALENTE_ACY_PRIMERA, MENINGOCOCO_TETRAVALENTE_ACY_SEGUNDA, MENINGOCOCO_TETRAVALENTE_ACY_REFUERZO, COVID_MODERNA_PEDIATRICA_PRIMERA, COVID_MODERNA_PEDIATRICA_SEGUNDA, COVID_PFIZER_ADICIONAL, VPH_UNICA, ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_PRIMERA, ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_SEGUNDA, ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_TERCERA, ANTIRABICA_HUMANA_INTRAMUSCULAR_PRE_EXPOSICION_REFUERZO, COVID_MODERNA_BIVALENTE_ADICIONAL, Codigo_Entidad, estado)
FROM 'C:\Hackhathon\Dataset_vacunacion_clean.csv' DELIMITER '|' CSV HEADER ENCODING 'UTF-8';